# Прогнозирование активности банкоматов с использованием Prophet и погодных данных

Этот проект включает в себя прогнозирование активности банкоматов с использованием временных рядов и модели **Prophet** от Facebook. Для улучшения точности прогнозов добавляются внешние регрессоры, такие как погодные условия (температура, влажность, осадки), а также кластеризация банкоматов с использованием алгоритма **TimeSeriesKMeans**.

## Описание

Мы используем временные ряды с данными о деятельности 1630 банкоматов на протяжении 3 месяцев. Для каждого банкомата строится прогноз на 1 месяц вперёд, с учётом следующих факторов:

- Погодные данные (температура, влажность, осадки, давление и т.д.)
- Кластеры, определяющие паттерны активности банкоматов

Для оценки качества модели используется кросс-валидация с использованием метрик `MSE` и `MAE`.

## Структура проекта

1. **Прогнозирование активности банкоматов**:
   - Используется модель Prophet для прогнозирования активности каждого банкомата на основе исторических данных и внешних регрессоров.
   
2. **Кросс-валидация**:
   - Модель проходит через несколько периодов обучения и тестирования, используя функцию кросс-валидации `cross_validation`, и оценивается с использованием метрик, таких как `MSE` и `MAE`.
     horizon='30 days'	Прогнозируем на 30 дней вперёд на каждом сплите
     initial='60 days'	Первая обучающая выборка минимум 60 дней
     period='15 days'	Каждые 15 дней берём новую точку отсчёта
   
3. **Кластеризация**:
   - Алгоритм TimeSeriesKMeans используется для кластеризации банкоматов на группы с схожими паттернами активности.

4. **Прогноз с учетом погоды**:
   - Добавляются погодные данные в качестве регрессоров для улучшения точности прогноза.
     Использовались данные https://www.meteoservice.ru/archive/moskva/
     Обработка в 04_weather.ipynb

## Выводы и улучшения
Так как пресдтавленный датасет мал (данные только за 3 месяца, к тому же нужно прогнозировать декабрь 2022 года обычно самый пиковый месяц с точки зрения трат), не стал использовать бустинг. Но бустинги являются гораздо более гибкими и мощными по сравнению с Prophet, так как могут обрабатывать сложные нелинейные зависимости, взаимодействие между признаками и использовать большое количество регрессоров (например, погодные данные, экономические индикаторы и т. д.).
Использовал Prophet потому что Prophet позволяет быстро получить модель, которая работает «из коробки» с минимальной настройкой.

На сайте https://www.gazprombank.ru/atms/
Пробовал через id Банкоматов выйти на часы работы каждого банкомата. Но, к сожалению, смэтчить данные не получилось. Возможно в дальнейшем в качестве шага к улучшению модели, можно добавить часы работы из внутренних источников.

Сначала я построил кластеры для группировки банкоматов в группы по гео признаку. Однако в дальнейшем группировал кластеры по паттернам активностей банкоматов. Возможно стоит использовать данные двух кластеризаций. 

Прогнозы сохранил в /data/atm_forecasts_december2022.csv

## Зависимости

Для работы с проектом необходимо установить следующие библиотеки:

```bash
pip install prophet
pip install pandas
pip install matplotlib
pip install sklearn
pip install tqdm
pip install statsmodels
pip install tslearn


